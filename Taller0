package Taller0;

import java.io.IOException;
import java.util.*;

public class Taller0 {

	public static int[][][][] sala;
	public static String[][] usuario;
	public static String[][] status;
	public static int totalusuario;
	public static int[] saldo;
	public static String[][] pelicula;
	public static int[] recaudacion;
	public static int totalmovies;
	public static boolean[][][] horario;
	
	
	public static void main(String [] args) throws IOException {
		sala = new int[3][2][10][30];
		usuario = new String[999][5];
		totalusuario= 0;
		status = new String [999][2];
		//int numerostatus = 0; no es necesario ya que es el mismo de totalusuario
		saldo = new int[999];
		pelicula = new String[99][2];
		//pelicula = new String[99][4];
		totalmovies =0;
		recaudacion = new int[99];
		horario = new boolean[99][3][2];
		boolean valido = leer();
		if (valido){
			boolean continuar = true;
			while(continuar) {
				continuar = inicio();
			}
			//guardar();
			
			
		}
		String op= "0";
		 String nombre;
		 String apellido;
		 String rut;
		 String clave;
		 String saldo;
		 int estado;
		 String nombrepelicula;
		 int tipopelicula;
		 String recaudacion;
		 String funcion;
		
		Scanner leer = new Scanner(System.in);
		do {
			System.out.println("""
					opciones
					1-guardar cliente
					2-guardar Status
					3-guardar películas
					""");
			op = leer.nextLine().toString();
			System.out.println("opciones"+ op);
			
			if (op.equals("1")) {
				
				System.out.println("Digite su nombre: ");
				nombre= leer.nextLine();
				
				System.out.print("Digite su Apellido: ");
				apellido= leer.nextLine();
				
				System.out.print("Digite su rut: ");
				rut= leer.nextLine();
				
				System.out.print("Digite su clave: ");
				clave= leer.nextLine();
				
				System.out.print("Digite su saldo: ");
				saldo= leer.nextLine();
				
				guardarCliente(numerousuario, nombre ,apellido ,rut,clave, saldo);
				numerousuario++;
				
			}
			if (op.equals("2")) {
				
				System.out.println("Digite su rut: ");
				rut= leer.nextLine();
				
				System.out.print("Digite su estado: (1- Habilitado / 2- No habilitado");
				estado= Integer.parseInt(leer.nextLine().toString());
				
				String nombreestado =(estado==1)?"habilitado": "no habilitado";
				guardarStatus(numerostatus, rut,nombreestado);
				numerostatus++;
			}
			
			if(op.equals("3")) {
				
				System.out.println("Nombre de la película: ");
				nombrepelicula= leer.nextLine();
				
				System.out.println("tipo de la película: (1- Estreno / 2- Liberada");
				tipopelicula= Integer.parseInt(leer.nextLine().toString());
				
				System.out.println("Recaudacion: ");
				recaudacion= leer.nextLine();
				
				System.out.println("Sala y horario: ");
				funcion= leer.nextLine();
				
				String nombretipopelicula =(tipopelicula==1)?"Estreno": "Liberada";
				guardarPeliculas (numeropelicula, nombrepelicula,nombretipopelicula, recaudacion, funcion);
				numeropelicula++;
				
			}
				
		}while(op!="4");
		
		
		System.out.println("SALIENDO DEL PROGRAMA, GRACIAS POR PREFERIRNOS");
	}
	
	public static boolean leer() {
		boolean valido = leerCliente();
		if (valido) {
			valido=leerStatus();
			if(valido) {
				valido=leerPeliculas();
			}
		}
		return valido;
	}
	
	public static boolean leerCliente() {
		try {
			File archivo = new File ("clientes.txt"); 
			FileReader text = new FileReader (archivo); 
			BufferedReader reader = new BufferedReader(text); 
			String linea;
			String[] partes;
			int contador=0;
			while((linea = reader.readLine())!=null && contador <999){
				partes = linea.split(",");
				usuario[contador][0]=partes[0];
				usuario[contador][1]=partes[1];
				usuario[contador][2]=partes[2];
				usuario[contador][3]=partes[3];
				saldo[contador]=Integer.parseInt(partes[4]);
				contador++;
			 }
			 reader.close();
			 totalusuario= contador;
			 return true;
		}
		catch (Exception e) {
			System.out.println("ARCHIVO DE CLIENTES CORRUPTO/INEXISTENTE");
			return false;
		}
	}
	
	public static boolean leerStatus() {
		try {
			File archivo = new File ("clientes.txt"); 
			FileReader text = new FileReader (archivo); 
			BufferedReader reader = new BufferedReader(text); 
			String linea;
			String[] partes;
			while((linea = reader.readLine())!=null){
				partes = linea.split(",");
				int direccion = getUsuario(partes[0]);
				if (direccion>=0) {
					usuario[direccion][4]=partes[1];
				}
			 }
			 reader.close();
			 return true;
		}
		catch (Exception e) {
			System.out.println("ARCHIVO DE STATUS CORRUPTO/INEXISTENTE");
			return false;
		}
	}
	
	public static boolean leerPeliculas() {
		try {
			File archivo = new File ("peliculas.txt"); 
			FileReader text = new FileReader (archivo); 
			BufferedReader reader = new BufferedReader(text); 
			String linea;
			String[] partes;
			int contador=0;
			while((linea = reader.readLine())!=null && contador <99){
				partes = linea.split(",");
				pelicula[contador][0]=partes[0];
				pelicula[contador][1]=partes[1];
				recaudacion[contador]=Integer.parseInt(partes[2]);
				int tamano = partes.length;
				for(int i=3;i<tamano;i+=2) {
					int coordenadas =0;
					if(partes[i+1].equals("T") || partes[i+1].equals("t")) {
						coordenadas=1;
					}
					horario[contador][Integer.parseInt(partes[i])][coordenadas]=true;
				}
				
				
				int direccion = getUsuario(partes[0]);
				if (direccion>=0) {
					usuario[direccion][4]=partes[1];
				}
				contador++;
			 }
			totalmovies=contador;
			 reader.close();
			 return true;
		}
		catch (Exception e) {
			System.out.println("ARCHIVO DE STATUS CORRUPTO/INEXISTENTE");
			return false;
		}
	}
	
	public static boolean inicio() {
		return false;
	}
	
	public static void crearUsuario(String rut) {
	}
	
	public static String decodificarRut(String rut) {
		String[] partes;
		partes = rut.split("");
		if(partes.length==12)
		{
			if(partes[11].equals("k"))
			{
				partes[11]="K";
			}
			return partes[0]+partes[1]+partes[3]+partes[4]+partes[5]+partes[7]+partes[8]+partes[9]+partes[11];
			
		}
		if(partes.length==11)
		{
			if(partes[10].equals("k"))
			{
				partes[10]="K";
			}
			return partes[0] + partes[2]+partes[3]+partes[4] + partes[6]+partes[7]+partes[8] +partes[10];
		}
		else if(partes.length==10)
		{
			if(partes[9].equals("k"))
			{
				partes[9]="K";
			}
			return partes[0]+partes[1]+partes[2]+partes[3]+partes[4]+partes[5]+partes[6]+partes[7]+partes[9];
		}
		else if(partes.length==9)
		{
			if(partes[8].equals("k"))
			{
				partes[8]="K";
			}
			return partes[0]+partes[1]+partes[2]+partes[3]+partes[4]+partes[5]+partes[6]+partes[7]+partes[8];
		}
		else if(partes.length==8)
		{
			if(partes[7].equals("k"))
			{
				partes[7]="K";
			}
			return partes[0]+partes[1]+partes[2]+partes[3]+partes[4]+partes[5]+partes[6]+partes[7];
		}
		else
		{
			return rut;
		}
	}
	
	public static int getUsuario(String rut) {
		return 0;
	}
	
	public static void cliente() {
	}
	
	public static void compra() {
	}
	
	public static void devolucion() {
	}
	
	public static void cartelera() {
	}
	
	public static void user() {
	}
	
	public static void ADMIN() {
	}
	
	public static void taquilla() {
	}
	
	public static void info() {
	}
	
	public static void guardarCliente (int numerousuario, String nombre, String apellido, String rut, String clave, String saldo) {
		usuario[numerousuario][0]= nombre+","+ apellido;
		usuario[numerousuario][1]= rut;
		usuario[numerousuario][2]= clave;
		usuario[numerousuario][3]= saldo;
	}
	
	public static void guardarStatus(int numerostatus, String rut,String estado) {
		
		status[numerostatus][0] = rut;
				
		status[numerostatus][1]	= estado;
		
	}
	
	public static void guardarPeliculas(int numeropelicula, String nombrepelicula, String tipopelicula, String recaudacion, String funcion) {
		pelicula[numeropelicula][0]= nombrepelicula;
		pelicula[numeropelicula][1]= tipopelicula;
		pelicula[numeropelicula][2]= recaudacion;
		pelicula[numeropelicula][3]= funcion;
		
	}

}
